import matplotlib.pyplot as plt
import pandas as pd
import numpy as np
import seaborn as sns

df = pd.read_csv('tmdb_5000_movies.csv')

# смотрим поля и данные
df.head()
df.shape
df.keys()

df['budget'].unique() 
# в некоторых ячейках присутствуют выбросы данных по отношению к среднему
(df['budget'] < 100).mean()
# можем увидеть почти нулевые бюджеты, что вероятно есть ошибка данных

# посмотрим на распределение бюджета, используем график ящик с усами(тип графика хорошо подходит для распределений), тип переменной budget - int64
df['budget'].plot(kind='box', title='Распределение бюджета', grid=True)
# хорошо видно что в освновном бюджеты фильмов распределены в пределах до 50 млн., присутствую выбросы(большие бюджеты) начиная от 100 млн

# на графике regplot(подходит для сравнения двух значений) посмотрим зависимость переменных vote_count(int64) и popularity(float64)
sns.regplot(data=df, y='vote_count', x='popularity', color='green', marker='+')
plt.title('Корреляция между доходом и проголосовавшими')
plt.ylim(0, 20000)
# можем оценить хорошую корреляцию популярности и кол-ва проголосовавших

# посмотрим на распределение средних оценок vote_average(int64), для этого используем гистограмму из др. библиотеки
sns.histplot(df['vote_average'])
plt.title('Распределение средних оценок')
# видим что большинство оцененок распределены от 4 до 8

# Посмотрим на то, как связаны между собой величины budget(int64) и revenue(int64)
sns.jointplot(x='budget', y='revenue', data=df, kind='reg')
# тут мы можем видить что определенная зависимость дохода от бюджета существует. 

# далее посмотрим на различные признаки в наборе данных и выберем отдельные для изучения
sns.pairplot(df)
# посмотрим vote_count(int64), revenue(int64) и budget(int64)
# смотрим подробнее на зависимость бюджета, дохода и кол-ва проголосовавших
sns.pairplot(df[['budget', 'revenue', 'vote_count']])
# зависимость роста дохода от роста кол-ва проголосовавших намного лучше отражается на доходе, чем от суммы бюджета

# соберем вместе числовые переменные чтобы посмотреть на их взаимную корреляцию и построим тепловую карту в этом наборе переменных есть два типа int64 и float64
df1 = df.groupby('budget')[['budget', 'popularity', 'revenue', 'vote_average', 'vote_count']].mean().corr()
sns.heatmap(data=df1, annot=True, cmap='PuBu')
# на тепловой видна зависимость между разными переменными, 
# например переменная popularity имеет меньшую корреляцию с доходом, чем кол-во проголосовавших
# также видно что зависимость популярности имеет среднюю корреляцию с суммой бюджета, при этом более сильную с доходом
